<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="xiaozhu-sorce"><meta name="copyright" content="xiaozhu-sorce"><meta name="generator" content="Hexo 5.4.2"><meta name="theme" content="hexo-theme-yun"><title>Javaé›†åˆæ¡†æ¶ä¹‹Map | ç–ç–|å½’ä¸€</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.2.4/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/@unocss/runtime/mini.global.js"></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/png" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"example.com","root":"/","title":"å°æœ±ã®ç«™ç‚¹","version":"1.8.11","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"/data/sentences.json"},"fireworks":{"colors":null},"vendors":{"darken":"https://cdn.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><meta name="description" content="Mapæ¥å£Mapå®ç°ç±»ç”¨äºä¿å­˜å…·æœ‰æ˜ å°„å…³ç³»çš„æ•°æ®ã€‚Mapä¿å­˜çš„æ¯é¡¹æ•°æ®éƒ½æ˜¯key-valueå¯¹ï¼Œä¹Ÿå°±æ˜¯ç”±keyå’Œvalueä¸¤ä¸ªå€¼ç»„æˆã€‚Mapé‡Œçš„keyæ˜¯ä¸å¯é‡å¤çš„ï¼Œkeyç”¨äºæ ‡è¯†é›†åˆé‡Œçš„æ¯é¡¹æ•°æ®ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="Javaé›†åˆæ¡†æ¶ä¹‹Map">
<meta property="og:url" content="http://example.com/2022/04/18/Java%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6%E4%B9%8BMap/index.html">
<meta property="og:site_name" content="ç–ç–|å½’ä¸€">
<meta property="og:description" content="Mapæ¥å£Mapå®ç°ç±»ç”¨äºä¿å­˜å…·æœ‰æ˜ å°„å…³ç³»çš„æ•°æ®ã€‚Mapä¿å­˜çš„æ¯é¡¹æ•°æ®éƒ½æ˜¯key-valueå¯¹ï¼Œä¹Ÿå°±æ˜¯ç”±keyå’Œvalueä¸¤ä¸ªå€¼ç»„æˆã€‚Mapé‡Œçš„keyæ˜¯ä¸å¯é‡å¤çš„ï¼Œkeyç”¨äºæ ‡è¯†é›†åˆé‡Œçš„æ¯é¡¹æ•°æ®ã€‚">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gyp0sw7mirj30n70bzdga.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h1hhdfzyl8j20st0akjsg.jpg">
<meta property="article:published_time" content="2022-04-18T10:42:38.000Z">
<meta property="article:modified_time" content="2022-04-21T09:40:46.277Z">
<meta property="article:author" content="xiaozhu-sorce">
<meta property="article:tag" content="é›†åˆ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tva1.sinaimg.cn/large/008i3skNly1gyp0sw7mirj30n70bzdga.jpg"><script>(function() {
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info mickey-mouse"><a class="site-author-avatar" href="/about/" title="xiaozhu-sorce"><img width="96" loading="lazy" src="https://i.loli.net/2021/03/23/2QaVR76DWpFEUhu.jpg" alt="xiaozhu-sorce"><span class="site-author-status" title="Don't want to work">ğŸ˜­</span></a><div class="site-author-name"><a href="/about/">xiaozhu-sorce</a></div><span class="site-name">ç–ç–|å½’ä¸€</span><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">10</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">5</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">5</span></a></div><a class="site-state-item hty-icon-button" href="/" title="æ–‡æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/xiaozhu-sorce" title="GitHub" target="_blank" style="color:#181717"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:me@790362227@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Map%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.</span> <span class="toc-text">Mapæ¥å£</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Map%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0%E7%B1%BB%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-number">1.1.</span> <span class="toc-text">Mapæ¥å£å®ç°ç±»çš„æ¯”è¾ƒ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HashMap"><span class="toc-number">2.</span> <span class="toc-text">HashMap</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%95%E5%B1%82%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">2.1.</span> <span class="toc-text">åº•å±‚æ•°æ®ç»“æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Node-lt-K-V-gt"><span class="toc-number">2.1.1.</span> <span class="toc-text">Node&lt;K,V&gt;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">2.1.2.</span> <span class="toc-text">æ¦‚è¿°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95%E5%92%8C%E5%93%88%E5%B8%8C%E5%86%B2%E7%AA%81"><span class="toc-number">2.2.</span> <span class="toc-text">å“ˆå¸Œç®—æ³•å’Œå“ˆå¸Œå†²çª</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hash-Object-key"><span class="toc-number">2.2.1.</span> <span class="toc-text">hash(Object key)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%93%BE%E5%9C%B0%E5%9D%80%E6%B3%95%EF%BC%88%E6%8B%89%E9%93%BE%E6%B3%95%EF%BC%89"><span class="toc-number">2.2.2.</span> <span class="toc-text">é“¾åœ°å€æ³•ï¼ˆæ‹‰é“¾æ³•ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#put-K-V"><span class="toc-number">2.3.</span> <span class="toc-text">put(K,V)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">2.3.1.</span> <span class="toc-text">å°ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%AE%B9%E6%9C%BA%E5%88%B6"><span class="toc-number">2.4.</span> <span class="toc-text">æ‰©å®¹æœºåˆ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#resize"><span class="toc-number">2.4.1.</span> <span class="toc-text">resize()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E7%A8%8B"><span class="toc-number">2.4.2.</span> <span class="toc-text">è¿‡ç¨‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%9F%E8%BD%BD%E5%9B%A0%E5%AD%90-loadFactor"><span class="toc-number">2.5.</span> <span class="toc-text">è´Ÿè½½å› å­ loadFactor</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#TreeMap"><span class="toc-number">3.</span> <span class="toc-text">TreeMap</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%95%E5%B1%82%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E2%80%93%E7%BA%A2%E9%BB%91%E6%A0%91"><span class="toc-number">3.1.</span> <span class="toc-text">åº•å±‚æ•°æ®ç»“æ„â€“çº¢é»‘æ ‘</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E6%80%A7"><span class="toc-number">3.1.1.</span> <span class="toc-text">ç‰¹æ€§</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F"><span class="toc-number">3.2.</span> <span class="toc-text">æ’åº</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://example.com/2022/04/18/Java%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6%E4%B9%8BMap/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="xiaozhu-sorce"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="ç–ç–|å½’ä¸€"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Javaé›†åˆæ¡†æ¶ä¹‹Map</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <span class="post-meta-icon-text">Posted on</span> <time title="Created: 2022-04-18 18:42:38" itemprop="dateCreated datePublished" datetime="2022-04-18T18:42:38+08:00">2022-04-18</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <span class="post-meta-icon-text">Edited on</span> <time title="Modified: 2022-04-21 17:40:46" itemprop="dateModified" datetime="2022-04-21T17:40:46+08:00">2022-04-21</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="Word count in article">4k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="Reading time">16m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Java/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Java</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/%E9%9B%86%E5%90%88/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">é›†åˆ</span></a></span></div><div class="post-author"><span class="author-name">å°æœ±</span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h1 id="Mapæ¥å£"><a href="#Mapæ¥å£" class="headerlink" title="Mapæ¥å£"></a>Mapæ¥å£</h1><p>Mapå®ç°ç±»ç”¨äºä¿å­˜å…·æœ‰æ˜ å°„å…³ç³»çš„æ•°æ®ã€‚Mapä¿å­˜çš„æ¯é¡¹æ•°æ®éƒ½æ˜¯key-valueå¯¹ï¼Œä¹Ÿå°±æ˜¯ç”±keyå’Œvalueä¸¤ä¸ªå€¼ç»„æˆã€‚Mapé‡Œçš„keyæ˜¯ä¸å¯é‡å¤çš„ï¼Œkeyç”¨äºæ ‡è¯†é›†åˆé‡Œçš„æ¯é¡¹æ•°æ®ã€‚</p>
<span id="more"></span> 

<p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gyp0sw7mirj30n70bzdga.jpg" alt="map" loading="lazy"></p>
<h2 id="Mapæ¥å£å®ç°ç±»çš„æ¯”è¾ƒ"><a href="#Mapæ¥å£å®ç°ç±»çš„æ¯”è¾ƒ" class="headerlink" title="Mapæ¥å£å®ç°ç±»çš„æ¯”è¾ƒ"></a>Mapæ¥å£å®ç°ç±»çš„æ¯”è¾ƒ</h2><ul>
<li><p>HashMapï¼šçº¿ç¨‹ä¸å®‰å…¨ï¼Œæ•ˆç‡è¾ƒé«˜ï¼›å­˜å‚¨nullçš„keyå’Œvalue</p>
<ul>
<li>LinkedHashMapï¼šä¿è¯åœ¨éå†mapå…ƒç´ æ—¶ï¼Œå¯ä»¥æŒ‰ç…§æ·»åŠ çš„é¡ºåºå®ç°éå†</li>
</ul>
</li>
<li><p>TreeMapï¼šä¿è¯æŒ‰ç…§æ·»åŠ çš„key-valueå¯¹è¿›è¡Œæ’åºï¼Œå®ç°æ’åºéå†ã€‚</p>
</li>
<li><p>Hashtableï¼šå¤è€çš„å®ç°ç±»ï¼›çº¿ç¨‹æ˜¯å®‰å…¨çš„ï¼Œæ•ˆç‡ä½ï¼›ä¸èƒ½å­˜å‚¨nullçš„keyå’Œvalue</p>
</li>
</ul>
<h1 id="HashMap"><a href="#HashMap" class="headerlink" title="HashMap"></a>HashMap</h1><h2 id="åº•å±‚æ•°æ®ç»“æ„"><a href="#åº•å±‚æ•°æ®ç»“æ„" class="headerlink" title="åº•å±‚æ•°æ®ç»“æ„"></a>åº•å±‚æ•°æ®ç»“æ„</h2><p>HashMapåœ¨Jdk8ä¹‹åå°±é‡‡ç”¨äº†<strong>æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘</strong>çš„å­˜å‚¨æ–¹å¼è¿›è¡Œå­˜å‚¨é”®å€¼å¯¹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">transient</span> Node&lt;K,V&gt;[] table;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">transient</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">transient</span> <span class="keyword">int</span> size;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">transient</span> <span class="keyword">int</span> modCount;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> threshold;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> <span class="keyword">float</span> loadFactor;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * The default initial capacity - MUST be a power of two.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_INITIAL_CAPACITY = <span class="number">1</span> &lt;&lt; <span class="number">4</span>; <span class="comment">// aka 16</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * The maximum capacity, used if a higher value is implicitly specified</span></span><br><span class="line"><span class="comment">   * by either of the constructors with arguments.</span></span><br><span class="line"><span class="comment">   * MUST be a power of two &lt;= 1&lt;&lt;30.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAXIMUM_CAPACITY = <span class="number">1</span> &lt;&lt; <span class="number">30</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>tableï¼šæ˜¯ä¸€ä¸ªå­˜æ”¾å…ƒç´ ç±»å‹ä¸ºNode&lt;K,V&gt;çš„ä¸€ä¸ªæ•°ç»„ï¼Œé€šè¿‡Keyå“ˆå¸Œä¹‹åçš„å€¼ä½œä¸ºæ•°ç»„ç´¢å¼•å¯ä»¥å¿«é€Ÿæ‰¾åˆ°è¿™ä¸ªNodeã€‚ç”±äºè¿™ä¸ªNodeå¯ä»¥ä½œä¸ºé“¾è¡¨çš„å¤´æˆ–è€…çº¢é»‘æ ‘çš„èŠ‚ç‚¹ï¼Œæˆä¸ºä¸€ä¸ªæ¡¶ã€‚æ‰€ä»¥è¿™ä¸ªæ•°ç»„ä¹Ÿå«å“ˆå¸Œæ¡¶æ•°ç»„ã€‚</li>
<li>entrySetï¼šå­˜å‚¨å…·ä½“é”®å€¼å¯¹çš„é›†</li>
<li>sizeï¼šæ˜¯HashMapä¸­å…·ä½“å­˜æ”¾çš„å…ƒç´ ï¼ˆä¹Ÿå°±æ˜¯ä¸€ä¸ªNode&lt;K,V&gt;å³é”®å€¼å¯¹ï¼‰çš„å¤§å°</li>
<li>modCountï¼šfail-fastæœºåˆ¶</li>
<li>thresholdï¼šé˜€å€¼ï¼Œå…¶å®å°±æ˜¯ä½œä¸ºä¸€ä¸ªä¸´ç•Œå€¼å»åˆ¤æ–­æ˜¯å¦è¦å¯¹hashMapè¿›è¡Œæ‰©å®¹</li>
<li>loadFactorï¼šè´Ÿè½½å› å­ã€‚ä¸€èˆ¬å€¼ä¸º0.75</li>
</ul>
<blockquote>
<p>threshold=å®¹é‡*è´Ÿè½½å› å­</p>
<p>å³threshold=capacity * loadFactor</p>
</blockquote>
<h3 id="Node-lt-K-V-gt"><a href="#Node-lt-K-V-gt" class="headerlink" title="Node&lt;K,V&gt;"></a>Node&lt;K,V&gt;</h3><p>Node&lt;K,V&gt;ä½œä¸ºä¸€ä¸ªé™æ€å†…éƒ¨ç±»å­˜åœ¨äºHashMapä¸­ï¼Œå…¶å®ç°äº†Map.Entry&lt;K,V&gt;æ¥å£ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªKey-Valueé”®å€¼å¯¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> hash;</span><br><span class="line">    <span class="keyword">final</span> K key;</span><br><span class="line">    V value;</span><br><span class="line">    Node&lt;K,V&gt; next;</span><br><span class="line"></span><br><span class="line">    Node(<span class="keyword">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;</span><br><span class="line">        <span class="keyword">this</span>.hash = hash;</span><br><span class="line">        <span class="keyword">this</span>.key = key;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> K <span class="title">getKey</span><span class="params">()</span>        </span>&#123; <span class="keyword">return</span> key; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">getValue</span><span class="params">()</span>      </span>&#123; <span class="keyword">return</span> value; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> key + <span class="string">&quot;=&quot;</span> + value; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Objects.hashCode(key) ^ Objects.hashCode(value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">setValue</span><span class="params">(V newValue)</span> </span>&#123;</span><br><span class="line">        V oldValue = value;</span><br><span class="line">        value = newValue;</span><br><span class="line">        <span class="keyword">return</span> oldValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">this</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (o <span class="keyword">instanceof</span> Map.Entry) &#123;</span><br><span class="line">            Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;</span><br><span class="line">            <span class="keyword">if</span> (Objects.equals(key, e.getKey()) &amp;&amp;</span><br><span class="line">                Objects.equals(value, e.getValue()))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1hhdfzyl8j20st0akjsg.jpg" alt="HashMap" loading="lazy"></p>
<p>å½“å®ä¾‹åŒ–ä¸€ä¸ªHashMapæ—¶ï¼Œä¼šåˆå§‹åŒ–initialCapacityå’ŒloadFactorï¼Œåœ¨putç¬¬ä¸€å¯¹æ˜ å°„å…³ç³»æ—¶ï¼Œç³»ç»Ÿä¼šåˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸ºinitialCapacityçš„Nodeæ•°ç»„ï¼Œè¿™ä¸ªé•¿åº¦åœ¨å“ˆå¸Œè¡¨ä¸­è¢«ç§°ä¸ºå®¹é‡(Capacity)ï¼Œåœ¨è¿™ä¸ªæ•°ç»„ä¸­å¯ä»¥å­˜æ”¾å…ƒç´ çš„ä½ç½®æˆ‘ä»¬ç§°ä¹‹ä¸º**â€œæ¡¶â€(bucket)**ï¼Œæ¯ä¸ªbucketéƒ½æœ‰è‡ªå·±çš„ç´¢å¼•ï¼Œç³»ç»Ÿå¯ä»¥æ ¹æ®ç´¢å¼•å¿«é€Ÿçš„æŸ¥æ‰¾bucketä¸­çš„å…ƒç´ </p>
<p>  æ¯ä¸ªbucketä¸­å­˜å‚¨ä¸€ä¸ªå…ƒç´ ï¼Œå³ä¸€ä¸ªNodeå¯¹è±¡ï¼Œä½†æ¯ä¸€ä¸ªNodeå¯¹è±¡å¯ä»¥å¸¦ä¸€ä¸ªå¼•ç”¨å˜é‡nextï¼Œç”¨äºæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå› æ­¤ï¼Œ<strong>åœ¨ä¸€ä¸ªæ¡¶ä¸­ï¼Œå°±æœ‰å¯èƒ½ç”Ÿæˆä¸€ä¸ªNodeé“¾ã€‚ä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªä¸€ä¸ªTreeNodeå¯¹è±¡</strong>ã€‚æ¯ä¸€ä¸ªTreeNodeå¯¹è±¡å¯ä»¥æœ‰ä¸¤ä¸ªå¶å­ç»“ç‚¹leftå’Œrightï¼Œå› æ­¤ï¼Œåœ¨ä¸€ä¸ªæ¡¶ä¸­ï¼Œå°±æœ‰å¯èƒ½ç”Ÿæˆä¸€ä¸ªTreeNodeæ ‘ã€‚è€Œæ–°æ·»åŠ çš„å…ƒç´ ä½œä¸ºé“¾è¡¨çš„lastï¼Œæˆ–æ ‘çš„å¶å­ç»“ç‚¹ã€‚</p>
<h2 id="å“ˆå¸Œç®—æ³•å’Œå“ˆå¸Œå†²çª"><a href="#å“ˆå¸Œç®—æ³•å’Œå“ˆå¸Œå†²çª" class="headerlink" title="å“ˆå¸Œç®—æ³•å’Œå“ˆå¸Œå†²çª"></a>å“ˆå¸Œç®—æ³•å’Œå“ˆå¸Œå†²çª</h2><p><strong>Hashç®—æ³•</strong>:å°±æ˜¯æ ¹æ®è®¾å®šçš„Hashå‡½æ•°H(key)å’Œå¤„ç†å†²çªæ–¹æ³•ï¼Œå°†ä¸€ç»„å…³é”®å­—æ˜ å°„åˆ°ä¸€ä¸ªæœ‰é™çš„åœ°å€åŒºé—´ä¸Šçš„ç®—æ³•ã€‚æ‰€ä»¥Hashç®—æ³•ä¹Ÿè¢«ç§°ä¸ºæ•£åˆ—ç®—æ³•ã€æ‚å‡‘ç®—æ³•ã€‚</p>
<p><strong>Hashè¡¨</strong>:é€šè¿‡Hashç®—æ³•åå¾—åˆ°çš„æœ‰é™åœ°å€åŒºé—´ä¸Šçš„é›†åˆã€‚æ•°æ®å­˜æ”¾çš„ä½ç½®å’Œkeyä¹‹å‰å­˜åœ¨ä¸€å®šçš„å…³ç³»(<code>H(key)=stored_value_hash(æ•°æ®å­˜æ”¾ä½ç½®)</code>),å¯ä»¥å®ç°å¿«é€ŸæŸ¥è¯¢ã€‚ä¸ä¹‹ç›¸å¯¹çš„ï¼Œå¦‚æœæ•°æ®å­˜æ”¾ä½ç½®å’Œkeyä¹‹é—´ä¸å­˜åœ¨ä»»ä½•å…³è”å…³ç³»çš„é›†åˆï¼Œç§°ä¹‹ä¸º<code>éHashè¡¨</code>ã€‚</p>
<p><strong>Hashå†²çª</strong>:ç”±äºç”¨äºè®¡ç®—çš„æ•°æ®æ˜¯æ— é™çš„<code>H(key),keyå±äº(-âˆ,+âˆ)</code>,è€Œæ˜ å°„åˆ°åŒºé—´æ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥è‚¯å®šä¼šå­˜åœ¨ä¸¤ä¸ªkey:key1,key2ï¼ŒH(key1)=H(key2)ï¼Œè¿™å°±æ˜¯hashå†²çªã€‚ä¸€èˆ¬çš„è§£å†³Hashå†²çªæ–¹æ³•æœ‰:å¼€æ”¾å®šå€æ³•ã€å†å“ˆå¸Œæ³•ã€é“¾åœ°å€æ³•ï¼ˆæ‹‰é“¾æ³•ï¼‰ã€å»ºç«‹å…¬å…±æº¢å‡ºåŒºã€‚</p>
<h3 id="hash-Object-key"><a href="#hash-Object-key" class="headerlink" title="hash(Object key)"></a>hash(Object key)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">int</span> h;</span><br><span class="line">       <span class="keyword">return</span> (key == <span class="keyword">null</span>) ? <span class="number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="number">16</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>hash()æ–¹æ³•è®¡ç®—keyåœ¨æ¡¶æ•°ç»„ä¸­åº”è¯¥å­˜æ”¾çš„ä½ç½®ã€‚è¿™é‡Œè°ƒç”¨äº†keyæ‰€å±ç±»çš„hashcodeæ–¹æ³•ï¼ŒåŒæ—¶å°†è¿™ä¸ªæ•°å­—çš„é«˜ä½16ä½è¿›è¡Œäº†å¼‚æˆ–è¿ç®—ã€‚</p>
<blockquote>
<p>å¦‚æœkeyç±»æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰ç±»ï¼Œéœ€è¦override hashCode()å’Œequals()æ–¹æ³•ï¼Œä»è¿™é‡Œä¹Ÿå¯ä»¥è§£é‡ŠObjectä½œä¸ºä¸€ä¸ªæ‰€æœ‰ç±»çš„è¶…ç±»æ‹¥æœ‰hashCodeå’Œequalsæ–¹æ³•çš„åŸå› ã€‚</p>
</blockquote>
<p>âš ï¸æ³¨æ„ï¼š</p>
<ol>
<li>ä¸ºä»€ä¹ˆè¦è¿›è¡Œé«˜ä½16ä½çš„å¼‚æˆ–è¿ç®—</li>
<li>è®¡ç®—äº†keyçš„å“ˆå¸Œä¹‹åï¼Œåœ¨å¾€tableæ•°ç»„å­˜æ”¾æ—¶ç´¢å¼• <strong>i = (n - 1) &amp; hash</strong></li>
</ol>
<p>è¿™é‡Œåšä¸€ä¸ªç®€è¦çš„å›ç­”ã€‚è¯¦ç»†è§£ç­”è¯·ç§»æ­¥<a target="_blank" rel="noopener" href="https://iulay1007.github.io/2021/11/19/HashMap/">å­¦å§åšå®¢</a></p>
<ol>
<li>ä½œé«˜ä½çš„16ä½å¼‚æˆ–æ˜¯ä¸ºäº†æ»¡è¶³æ•°ç»„tableæ•°ç»„é•¿åº¦ä¸€èˆ¬å°äº16çš„ç‰¹æ€§ï¼Œå¹¶ä¸”ä¸ºäº†å‡å°‘å“ˆå¸Œå†²çªè€Œå°†é«˜16ä½çš„ç‰¹æ€§ä¹Ÿåœ¨ä½16ä½ä¸­ä½“ç°å‡ºæ¥ã€‚</li>
<li>è¿™é‡Œçš„ i å…¶å®å°±æ˜¯è®¡ç®—å“ˆå¸Œå€¼å¯¹æ•°ç»„é•¿åº¦å–æ¨¡çš„ç»“æœï¼Œä½†æ˜¯ä¸ºäº†ä½¿å¾—è¿ç®—æ•ˆç‡æ›´é«˜æ‰€ä»¥é‡‡ç”¨äº† å“ˆå¸Œå€¼å’Œæ•°ç»„é•¿åº¦å‡ä¸€è¿›è¡Œé€»è¾‘ä¸è¿ç®—ã€‚è€Œå¯ä»¥è¿™æ ·è¿ç®—çš„ä¸€ä¸ªé‡è¦çš„åŸå› ä¹Ÿæ˜¯tableçš„é•¿åº¦æ°¸è¿œæ˜¯2çš„æŒ‡æ•°æ¬¡æ–¹ã€‚</li>
</ol>
<h3 id="é“¾åœ°å€æ³•ï¼ˆæ‹‰é“¾æ³•ï¼‰"><a href="#é“¾åœ°å€æ³•ï¼ˆæ‹‰é“¾æ³•ï¼‰" class="headerlink" title="é“¾åœ°å€æ³•ï¼ˆæ‹‰é“¾æ³•ï¼‰"></a>é“¾åœ°å€æ³•ï¼ˆæ‹‰é“¾æ³•ï¼‰</h3><p>å°†å“ˆå¸Œå€¼ç›¸åŒçš„å…ƒç´ æ„æˆä¸€ä¸ªåŒä¹‰è¯çš„å•é“¾è¡¨,å¹¶å°†å•é“¾è¡¨çš„å¤´æŒ‡é’ˆå­˜æ”¾åœ¨å“ˆå¸Œè¡¨çš„ç¬¬iä¸ªå•å…ƒä¸­ï¼ŒæŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤ä¸»è¦åœ¨åŒä¹‰è¯é“¾è¡¨ä¸­è¿›è¡Œã€‚é“¾è¡¨æ³•é€‚ç”¨äºç»å¸¸è¿›è¡Œæ’å…¥å’Œåˆ é™¤çš„æƒ…å†µã€‚HashMapé‡‡ç”¨çš„å°±æ˜¯é“¾åœ°å€æ³•æ¥è§£å†³hashå†²çªã€‚(é“¾è¡¨é•¿åº¦å¤§äºç­‰äº8æ—¶è½¬ä¸ºçº¢é»‘æ ‘)</p>
<h2 id="put-K-V"><a href="#put-K-V" class="headerlink" title="put(K,V)"></a>put(K,V)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> putVal(hash(key), key, value, <span class="keyword">false</span>, <span class="keyword">true</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Implements Map.put and related methods.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> hash hash for key</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> key the key</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> value the value to put</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> onlyIfAbsent if true, don&#x27;t change existing value</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> evict if false, the table is in creation mode.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> previous value, or null if none</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent,</span></span></span><br><span class="line"><span class="function"><span class="params">                 <span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">      Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="keyword">int</span> n, i;</span><br><span class="line">      <span class="keyword">if</span> ((tab = table) == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">          n = (tab = resize()).length;</span><br><span class="line">     <span class="comment">//nodeå­˜æ”¾çš„ä½ç½®iæ˜¯å°†é•¿åº¦-1å’Œhashä½œé€»è¾‘ä¸è¿ç®—</span></span><br><span class="line">      <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="keyword">null</span>)</span><br><span class="line">          tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">          Node&lt;K,V&gt; e; K k;</span><br><span class="line">          <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">              ((k = p.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">              e = p;</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">              e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="keyword">this</span>, tab, hash, key, value);</span><br><span class="line">          <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">int</span> binCount = <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                  <span class="keyword">if</span> ((e = p.next) == <span class="keyword">null</span>) &#123;</span><br><span class="line">                      p.next = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">                      <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                          treeifyBin(tab, hash);</span><br><span class="line">                      <span class="keyword">break</span>;</span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                      ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                      <span class="keyword">break</span>;</span><br><span class="line">                  p = e;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123; <span class="comment">// existing mapping for key</span></span><br><span class="line">              V oldValue = e.value;</span><br><span class="line">              <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="keyword">null</span>)</span><br><span class="line">                  e.value = value;</span><br><span class="line">              afterNodeAccess(e);</span><br><span class="line">              <span class="keyword">return</span> oldValue;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      ++modCount;</span><br><span class="line">      <span class="keyword">if</span> (++size &gt; threshold)</span><br><span class="line">          resize();</span><br><span class="line">      afterNodeInsertion(evict);</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>ç»™HashMapä¸­å­˜æ”¾å…ƒç´ ï¼Œå…¶è¿‡ç¨‹å¯ä»¥å¤§æ¦‚åˆ†ä¸ºä»¥ä¸‹ï¼š</p>
<p>å‡è®¾ç°åœ¨newçš„ä¸€ä¸ªHashMap å˜é‡åä¸ºmapï¼Œç°åœ¨è°ƒç”¨map.put(key1,value2)</p>
<ol>
<li><p>æ ¹æ®key1æ‰€è‡ªç±»çš„hashcodeè®¡ç®—key1çš„å“ˆå¸Œå€¼ï¼Œæ­¤å“ˆå¸Œå€¼ç»è¿‡æŸç§è®¡ç®—ä¹‹åå¾—åˆ°ä¸€ä¸ªåœ¨Nodeæ•°ç»„ä¸­å­˜æ”¾çš„å…·ä½“ä½ç½®</p>
</li>
<li><p>å¦‚æœæ­¤ä½ç½®ä¸­çš„å…ƒç´ ä¸ºç©ºåˆ™ç›´æ¥è¿›è¡Œæ’å…¥</p>
</li>
<li><p>å¦‚æœæ­¤ä½ç½®çš„å…ƒç´ ä¸ä¸ºç©º</p>
<ol>
<li><p>åˆ¤æ–­è¯¥ä½ç½®çš„ç¬¬ä¸€ä¸ªæ•°æ®å’Œæˆ‘ä»¬è¦æ’å…¥çš„æ•°æ®ï¼Œkey 1æ˜¯ä¸æ˜¯â€ç›¸ç­‰â€ï¼Œå¦‚æœæ˜¯ï¼Œå–å‡ºè¿™ä¸ªèŠ‚ç‚¹</p>
</li>
<li><p>å¦‚æœè¿™ä¸ªå…ƒç´ çš„ç±»å‹ä¸ºTreeNodeï¼ˆä¹Ÿå°±æ˜¯è¿™ä¸ªæ¡¶ç°åœ¨å˜ä¸ºäº†çº¢é»‘æ ‘ï¼‰ï¼Œåˆ™äº¤ç»™TreeNodeå†…éƒ¨ç±»ä¸­çš„<code>putTreeVal</code>æ–¹æ³•è¿›è¡Œçº¢é»‘æ ‘ä¸­çš„èŠ‚ç‚¹æ·»åŠ </p>
</li>
<li><p>å¦åˆ™ï¼ˆè¿™ä¸ªæ¡¶æ˜¯é“¾è¡¨ï¼‰åˆ™è¿›è¡Œé“¾è¡¨çš„éå†</p>
<ol>
<li>å¦‚æœé“¾è¡¨çš„ä¸‹ä¸€ä¸ªå…ƒç´ ä¸ºç©ºï¼Œåˆ™è¿›è¡Œæ’å…¥ï¼ˆè¿™é‡Œé“¾è¡¨çš„æ’å…¥æ˜¯ä¸€ä¸ªå°¾æ’ï¼‰ã€‚å¦‚æœæ’å…¥çš„å…ƒç´ åˆšå¥½ä¸ºç¬¬å…«ä¸ªï¼ˆå–å†³äºå¸¸æ•°ï¼šTREEIFY_THRESHOLDï¼‰åˆ™æ‰§è¡Œ treeifyBin(tab, hash)å†³å®šæœ€åæ˜¯å¦éœ€è¦æ ‘å½¢åŒ–ã€‚</li>
<li>å¦‚æœåœ¨è¯¥é“¾è¡¨ä¸­æ‰¾åˆ°äº†â€ç›¸ç­‰â€çš„ keyï¼Œåˆ™é€€å‡ºå¾ªç¯ï¼Œå¯¹è¯¥Nodeä¸­çš„valueè¿›è¡Œæ›´æ–°ï¼ˆè¿™é‡Œå¯¹è¿™ä¸ªifåšä¸€ä¸ªè¯¦ç»†ä»‹ç»ï¼‰</li>
</ol>
<blockquote>
<p>if (e.hash == hash &amp;&amp;</p>
<pre><code>                    ( (k = e.key) == key || (key != null &amp;&amp; key.equals(k) ) ) )
</code></pre>
<p>è¿™é‡Œå…ˆå¯¹ä¸¤ä¸ªhashå’Œkeyè¿›è¡Œåˆ¤æ–­ï¼Œè‹¥äºŒè€…éƒ½ç›¸åŒï¼Œåˆ™è¡¨ç¤ºåŸå…ˆçš„mapä¸­æœ‰è¯¥key</p>
<p>è¿˜æœ‰å¦å¤–ä¸€ç§å¯èƒ½æ˜¯ï¼Œkeyä¸æ˜¯ç©ºçš„ï¼Œä½†æ˜¯äºŒè€…åœ¨é€»è¾‘ä¸Šæ˜¯ç›¸åŒçš„ï¼ˆæ ¹æ®ç”¨æˆ·é‡å†™çš„equalsæ–¹æ³•æˆ–è€…keyæ‰€å±ç±»çš„equalsæ–¹æ³•ï¼‰</p>
<p>å¥½æ¯”newäº†ä¸¤ä¸ªâ€Aâ€ï¼Œè¿™ä¸ªæ—¶å€™Aåœ¨é€»è¾‘ä¸Šæ˜¯ç›¸åŒçš„ï¼Œä½†ä»–ä»¬å„è‡ªå“ˆå¸Œå…¶å®æ˜¯ä¸åŒçš„ç»“æœã€‚</p>
<p>æ€»è€Œè¨€ä¹‹ï¼Œè¿™é‡Œè¯´çš„æ‰¾åˆ°äº†â€œç›¸ç­‰â€å…¶å®å°±æ˜¯â€œ==â€æˆ–è€…â€œequalsâ€ä¸¤è€…ä¹‹ä¸€æˆç«‹å³å¯ã€‚</p>
</blockquote>
</li>
</ol>
</li>
</ol>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><ul>
<li>é¦–æ¬¡è°ƒç”¨put()æ–¹æ³•æ—¶ï¼Œåº•å±‚åˆ›å»ºé•¿åº¦ä¸º16çš„æ•°ç»„ï¼ˆè¿™ä¸ªæ•°ç»„çš„é•¿åº¦å¿…é¡»ä¸º2çš„æ•´æ•°æ¬¡æ–¹ï¼‰</li>
<li>å½“æ•°ç»„çš„æŸä¸€ä¸ªç´¢å¼•ä½ç½®ä¸Šçš„å…ƒç´ ä»¥é“¾è¡¨å½¢å¼å­˜åœ¨çš„æ•°æ®ä¸ªæ•° &gt;= 8 ä¸”å½“å‰tableæ•°ç»„çš„é•¿åº¦ &gt; 64æ—¶ï¼Œæ­¤æ—¶æ­¤ç´¢å¼•ä½ç½®ä¸Šçš„æ‰€æ•°æ®æ”¹ä¸ºä½¿ç”¨çº¢é»‘æ ‘å­˜å‚¨ã€‚è‹¥æ•°ç»„é•¿åº¦&lt;64åˆ™åªæ˜¯è¿›è¡Œæ‰©å®¹ï¼Œå…ˆä¸è¿›è¡Œæ ‘å½¢åŒ–ã€‚ï¼ˆ<code>treeifyBin()</code>çš„æºç ã€‚ï¼‰</li>
</ul>
<h2 id="æ‰©å®¹æœºåˆ¶"><a href="#æ‰©å®¹æœºåˆ¶" class="headerlink" title="æ‰©å®¹æœºåˆ¶"></a>æ‰©å®¹æœºåˆ¶</h2><h3 id="resize"><a href="#resize" class="headerlink" title="resize()"></a>resize()</h3><p>åœ¨hashmapç¬¬ä¸€æ¬¡æ”¾å…¥å…ƒç´ ï¼Œé›†åˆçš„é•¿åº¦ä¸º0æˆ–è€…åœ¨æ·»åŠ å…ƒç´ ä¹‹åmapçš„size&gt;thresholdï¼ˆé˜€å€¼ï¼‰çš„æ—¶å€™éƒ½ä¼šè°ƒç”¨resizeæ–¹æ³•ã€‚</p>
<h3 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h3><p>å°†æ—§æ•°ç»„ä¸­çš„å…ƒç´ å¤åˆ¶åˆ°æ–°æ•°ç»„ï¼ˆ2å€çš„æ—§æ•°ç»„é•¿åº¦ï¼‰ä¸­ï¼Œä½†æ˜¯è¿™é‡Œçš„tableæ”¾å…¥å…ƒç´ çš„ä½ç½®æ˜¯é€šè¿‡ä¸Šè¿°è¯´çš„ tab[i = (n - 1) &amp; hash]ï¼Œæ‰€ä»¥åœ¨å¤åˆ¶åˆ°æ–°æ•°ç»„çš„æ—¶å€™ï¼Œæ¯ä¸ªå…ƒç´ çš„ä½ç½®ä¹Ÿéœ€è¦é‡æ–°è®¡ç®—ã€‚è€Œä¸å¯ä»¥ç®€å•çš„è¿›è¡Œå¤åˆ¶ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class="line">      Node&lt;K,V&gt;[] oldTab = table;</span><br><span class="line">      <span class="keyword">int</span> oldCap = (oldTab == <span class="keyword">null</span>) ? <span class="number">0</span> : oldTab.length;</span><br><span class="line">      <span class="keyword">int</span> oldThr = threshold;</span><br><span class="line">      <span class="keyword">int</span> newCap, newThr = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> (oldCap &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class="line">              threshold = Integer.MAX_VALUE;</span><br><span class="line">              <span class="keyword">return</span> oldTab;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span> ((newCap = oldCap &lt;&lt; <span class="number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class="line">                   oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class="line">              newThr = oldThr &lt;&lt; <span class="number">1</span>; <span class="comment">// double threshold</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (oldThr &gt; <span class="number">0</span>) <span class="comment">// initial capacity was placed in threshold</span></span><br><span class="line">          newCap = oldThr;</span><br><span class="line">      <span class="keyword">else</span> &#123;               <span class="comment">// zero initial threshold signifies using defaults</span></span><br><span class="line">          newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class="line">          newThr = (<span class="keyword">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (newThr == <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="keyword">float</span> ft = (<span class="keyword">float</span>)newCap * loadFactor;</span><br><span class="line">          newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class="keyword">float</span>)MAXIMUM_CAPACITY ?</span><br><span class="line">                    (<span class="keyword">int</span>)ft : Integer.MAX_VALUE);</span><br><span class="line">      &#125;</span><br><span class="line">      threshold = newThr;</span><br><span class="line">      <span class="meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span></span><br><span class="line">      Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class="keyword">new</span> Node[newCap];</span><br><span class="line">      table = newTab;</span><br><span class="line">      <span class="keyword">if</span> (oldTab != <span class="keyword">null</span>) &#123;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class="line">              Node&lt;K,V&gt; e;</span><br><span class="line">              <span class="keyword">if</span> ((e = oldTab[j]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                  oldTab[j] = <span class="keyword">null</span>;</span><br><span class="line">                  <span class="keyword">if</span> (e.next == <span class="keyword">null</span>)</span><br><span class="line">                    <span class="comment">//é‡æ–°è®¡ç®—æ”¾å…¥çš„ä½ç½®ã€‚</span></span><br><span class="line">                      newTab[e.hash &amp; (newCap - <span class="number">1</span>)] = e;</span><br><span class="line">                  <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                      ((TreeNode&lt;K,V&gt;)e).split(<span class="keyword">this</span>, newTab, j, oldCap);</span><br><span class="line">                  <span class="keyword">else</span> &#123; <span class="comment">// preserve order</span></span><br><span class="line">                      Node&lt;K,V&gt; loHead = <span class="keyword">null</span>, loTail = <span class="keyword">null</span>;</span><br><span class="line">                      Node&lt;K,V&gt; hiHead = <span class="keyword">null</span>, hiTail = <span class="keyword">null</span>;</span><br><span class="line">                      Node&lt;K,V&gt; next;</span><br><span class="line">								<span class="comment">// éœ€è¦å°†æ­¤é“¾è¡¨æ‹†æˆä¸¤ä¸ªé“¾è¡¨ï¼Œæ”¾åˆ°æ–°çš„æ•°ç»„ä¸­ï¼Œå¹¶ä¸”ä¿ç•™åŸæ¥çš„å…ˆåé¡ºåº</span></span><br><span class="line">                  <span class="comment">// loHeadã€loTail å¯¹åº”ä¸€æ¡é“¾è¡¨ï¼ŒhiHeadã€hiTail å¯¹åº”å¦ä¸€æ¡é“¾è¡¨</span></span><br><span class="line">                      <span class="keyword">do</span> &#123;</span><br><span class="line">                          next = e.next;</span><br><span class="line">                        <span class="comment">//å­˜æ”¾åœ¨æ—§çš„index,loHeadä¸ºå¤´ï¼ŒloTailä¸ºå°¾</span></span><br><span class="line">                          <span class="keyword">if</span> ((e.hash &amp; oldCap) == <span class="number">0</span>) &#123;</span><br><span class="line">                              <span class="keyword">if</span> (loTail == <span class="keyword">null</span>)</span><br><span class="line">                                  loHead = e;</span><br><span class="line">                              <span class="keyword">else</span></span><br><span class="line">                                  loTail.next = e;</span><br><span class="line">                              loTail = e;</span><br><span class="line">                          &#125;</span><br><span class="line">                        <span class="comment">//å­˜æ”¾åœ¨æ–°çš„index,hiHeadä¸ºå¤´ï¼ŒhiTailä¸ºå°¾</span></span><br><span class="line">                          <span class="keyword">else</span> &#123;</span><br><span class="line">                              <span class="keyword">if</span> (hiTail == <span class="keyword">null</span>)</span><br><span class="line">                                  hiHead = e;</span><br><span class="line">                              <span class="keyword">else</span></span><br><span class="line">                                  hiTail.next = e;</span><br><span class="line">                              hiTail = e;</span><br><span class="line">                          &#125;</span><br><span class="line">                      &#125; <span class="keyword">while</span> ((e = next) != <span class="keyword">null</span>);</span><br><span class="line">                    <span class="comment">//è¯¥æ®µé“¾è¡¨æ”¾å…¥æ—§indexå¤„</span></span><br><span class="line">                      <span class="keyword">if</span> (loTail != <span class="keyword">null</span>) &#123;</span><br><span class="line">                          loTail.next = <span class="keyword">null</span>;</span><br><span class="line">                          newTab[j] = loHead;</span><br><span class="line">                      &#125;</span><br><span class="line">                    <span class="comment">//è¯¥æ®µé“¾è¡¨æ”¾å…¥æ–°çš„indexå¤„</span></span><br><span class="line">                      <span class="keyword">if</span> (hiTail != <span class="keyword">null</span>) &#123;</span><br><span class="line">                          hiTail.next = <span class="keyword">null</span>;</span><br><span class="line">                          newTab[j + oldCap] = hiHead;</span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> newTab;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>å¯¹è¿™é‡Œçš„do-whileå¾ªç¯å¤„ç†é“¾è¡¨çš„è¯¦ç»†ä»‹ç»å¯ä»¥çœ‹<a target="_blank" rel="noopener" href="https://xie.infoq.cn/article/d8424c9d9350ca28cc9f2daf8">è¿™é‡Œ</a>ï¼Œéœ€è¦å…³æ³¨çš„å°±æ˜¯<code>if ((e.hash &amp; oldCap) == 0)</code>è¿™ä¸ªifè¯­å¥ä¸ºä»€ä¹ˆå¯ä»¥åˆ¤æ–­å…ƒç´ åœ¨æ–°å“ˆå¸Œæ¡¶ä½ç½®ã€‚</p>
<p>ç”±äºputæ—¶è®¡ç®—hashæ•°ç»„ä¸‹æ ‡æ˜¯é€šè¿‡<code>i = (n - 1) &amp; hash</code>è®¡ç®—çš„ï¼Œå…¶ä¸­næ˜¯çš„2çš„xæ¬¡å¹‚ï¼Œæ‰©å®¹æ—¶ï¼Œå®¹é‡å˜ä¸ºåŸæ¥çš„ä¸¤å€,<code>n-1 == (n-1)&lt;&lt;1 &amp; 1</code>ï¼Œæ‰€ä»¥hashæ¡¶ä¸­çš„å…ƒç´ ï¼Œè¦ä¹ˆè¿˜åœ¨åŸæ¥çš„indexä½ç½®ï¼Œè¦ä¹ˆåœ¨<code>oldIndex+oldCap</code>çš„ä½ç½®ã€‚æ‰€ä»¥æ”¾å…¥æ–°çš„indexæ—¶ï¼Œå…ƒç´ ä¸‹æ ‡:<code>newTab[j + oldCap]</code>ã€‚</p>
<h2 id="è´Ÿè½½å› å­-loadFactor"><a href="#è´Ÿè½½å› å­-loadFactor" class="headerlink" title="è´Ÿè½½å› å­ loadFactor"></a>è´Ÿè½½å› å­ loadFactor</h2><ul>
<li>è´Ÿè½½å› å­çš„å¤§å°å†³å®šäº†HashMapçš„æ•°æ®å¯†åº¦ã€‚</li>
<li>è´Ÿè½½å› å­è¶Šå¤§å¯†åº¦è¶Šå¤§ï¼Œå‘ç”Ÿç¢°æ’çš„å‡ ç‡è¶Šé«˜ï¼Œæ•°ç»„ä¸­çš„é“¾è¡¨è¶Šå®¹æ˜“é•¿,é€ æˆæŸ¥è¯¢æˆ–æ’å…¥æ—¶çš„æ¯”è¾ƒæ¬¡æ•°å¢å¤šï¼Œæ€§èƒ½ä¼šä¸‹é™ã€‚</li>
<li>è´Ÿè½½å› å­è¶Šå°ï¼Œå°±è¶Šå®¹æ˜“è§¦å‘æ‰©å®¹ï¼Œæ•°æ®å¯†åº¦ä¹Ÿè¶Šå°ï¼Œæ„å‘³ç€å‘ç”Ÿç¢°æ’çš„å‡ ç‡è¶Šå°ï¼Œæ•°ç»„ä¸­çš„é“¾è¡¨ä¹Ÿå°±è¶ŠçŸ­ï¼ŒæŸ¥è¯¢å’Œæ’å…¥æ—¶æ¯”è¾ƒçš„æ¬¡æ•°ä¹Ÿè¶Šå°ï¼Œæ€§èƒ½ä¼šæ›´é«˜ã€‚ä½†æ˜¯ä¼šæµªè´¹ä¸€å®šçš„å†…å®¹ç©ºé—´ã€‚è€Œä¸”ç»å¸¸æ‰©å®¹ä¹Ÿä¼šå½±å“æ€§èƒ½ï¼Œå»ºè®®åˆå§‹åŒ–é¢„è®¾å¤§ä¸€ç‚¹çš„ç©ºé—´ã€‚</li>
<li>æŒ‰ç…§å…¶ä»–è¯­è¨€çš„å‚è€ƒåŠç ”ç©¶ç»éªŒï¼Œä¼šè€ƒè™‘å°†è´Ÿè½½å› å­è®¾ç½®ä¸º0.7~0.75ï¼Œæ­¤æ—¶å¹³å‡æ£€ç´¢é•¿åº¦æ¥è¿‘äºå¸¸æ•°</li>
</ul>
<h1 id="TreeMap"><a href="#TreeMap" class="headerlink" title="TreeMap"></a>TreeMap</h1><h2 id="åº•å±‚æ•°æ®ç»“æ„â€“çº¢é»‘æ ‘"><a href="#åº•å±‚æ•°æ®ç»“æ„â€“çº¢é»‘æ ‘" class="headerlink" title="åº•å±‚æ•°æ®ç»“æ„â€“çº¢é»‘æ ‘"></a>åº•å±‚æ•°æ®ç»“æ„â€“çº¢é»‘æ ‘</h2><p>TreeMapä¸ä»…å¯ä»¥å¯¹key-valueè¿›è¡Œå­˜å‚¨ï¼Œè¿˜å¯ä»¥å¯¹å…¶è¿›è¡Œæ’åºï¼Œä½¿ç”¨äºŒå‰æ ‘çš„å­˜å‚¨ä½¿å¯¹å…ƒç´ çš„æŸ¥æ‰¾æ›´åŠ é«˜æ•ˆã€‚æ—¶é—´å¤æ‚åº¦ä¸ºOï¼ˆlognï¼‰ã€‚ä½†æ˜¯äºŒå‰æ ‘ä¼šå‘ç”Ÿä¸€äº›æç«¯çš„æƒ…å†µï¼Œæ¯”å¦‚å…¨éƒ¨å…ƒç´ ä¸ºåšä¸ºçˆ¶èŠ‚ç‚¹çš„å·¦å­©å­ï¼Œè¿™æ—¶å€™ï¼Œä¸å…¶è¯´ä»–æ˜¯ä¸ªæ ‘ï¼Œä¸å¦‚è¯´æ˜¯ä¸€æ¡é“¾è¡¨ï¼ŒæŸ¥æ‰¾æ•ˆç‡å¹¶æ²¡æœ‰å¾—åˆ°æå‡ã€‚</p>
<p>åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬åˆé‡‡ç”¨äº†AVLï¼ˆå¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼‰ï¼Œè™½ç„¶äºŒå‰æœç´¢æ ‘ä½¿å¾—å·¦å­©å­çš„å€¼å°äºæ ¹èŠ‚ç‚¹è€Œå³å­©å­çš„å€¼å¤§äºæ ¹èŠ‚ç‚¹ï¼Œä¼˜åŒ–äº†æœç´¢ï¼Œç”±äºäºŒå‰å¹³è¡¡æ ‘é«˜åº¦å¹³è¡¡ï¼ˆå·¦å³å­©å­çš„æ·±åº¦&lt;=1ï¼‰ï¼Œä½¿å¾—åœ¨æ’å…¥åˆ é™¤å…ƒç´ çš„æ—¶å€™éœ€è¦è¿›è¡Œä¸åœçš„è°ƒæ•´ï¼Œåœ¨æˆ‘ä»¬å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­åè€Œä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚</p>
<p>æ‰€ä»¥æœ€åé‡‡ç”¨äº†çº¢é»‘æ ‘ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹çº¢é»‘æ ‘çš„ç‰¹æ€§ï¼š</p>
<h3 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h3><p>ä¸€æ£µæ ‘å¯ä»¥è¢«å«åšçº¢é»‘æ ‘ï¼Œå¿…é¡»æ»¡è¶³ä¸€ä¸‹å‡ ç‚¹è¦æ±‚ï¼š</p>
<ul>
<li>æ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹å¿…é¡»æ˜¯æœ‰é¢œè‰²çš„ï¼Œè¦ä¹ˆçº¢è‰²ï¼Œè¦ä¹ˆé»‘è‰²</li>
<li>æ ‘ä¸­çš„æ ¹èŠ‚ç‚¹å¿…é¡»æ˜¯é»‘è‰²çš„</li>
<li>æ ‘ä¸­çš„å¶èŠ‚ç‚¹å¿…é¡»æ˜¯é»‘è‰²çš„</li>
<li>æ ‘ä¸­çš„ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹å¦‚æœæ˜¯çº¢è‰²çš„ï¼Œé‚£ä¹ˆå®ƒçš„ä¸¤ä¸ªå­èŠ‚ç‚¹ä¸€å®šæ˜¯é»‘è‰²çš„ã€</li>
<li>ä»»æ„èŠ‚ç‚¹åˆ°è¾¾å¶èŠ‚ç‚¹çš„æ¯ä¸€æ¡è·¯å¾„åŒ…å«çš„é»‘è‰²èŠ‚ç‚¹æ•°ç›®ä¸€å®šç›¸åŒ</li>
</ul>
<p>è¿™äº›çº¦æŸå¼ºåˆ¶äº†çº¢é»‘æ ‘çš„å…³é”®æ€§è´¨: ä»æ ¹åˆ°å¶å­çš„æœ€é•¿çš„å¯èƒ½è·¯å¾„ä¸å¤šäºæœ€çŸ­çš„å¯èƒ½è·¯å¾„çš„ä¸¤å€é•¿ã€‚ç»“æœæ˜¯è¿™æ£µæ ‘å¤§è‡´ä¸Šæ˜¯å¹³è¡¡çš„ã€‚å› ä¸ºæ“ä½œæ¯”å¦‚æ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾æŸä¸ªå€¼çš„æœ€åæƒ…å†µæ—¶é—´éƒ½è¦æ±‚ä¸æ ‘çš„é«˜åº¦æˆæ¯”ä¾‹ï¼Œè¿™ä¸ªåœ¨é«˜åº¦ä¸Šçš„ç†è®ºä¸Šé™å…è®¸çº¢é»‘æ ‘åœ¨æœ€åæƒ…å†µä¸‹éƒ½æ˜¯é«˜æ•ˆçš„ï¼Œè€Œä¸åŒäºæ™®é€šçš„äºŒå‰æŸ¥æ‰¾æ ‘ã€‚æ‰€ä»¥çº¢é»‘æ ‘å®ƒæ˜¯å¤æ‚è€Œé«˜æ•ˆçš„ï¼Œå…¶æ£€ç´¢æ•ˆç‡O(log n)ã€‚</p>
<p>åŸºäºè¿™äº›ç‰¹æ€§ï¼Œè€Œæˆ‘ä»¬è¦å¯¹TreeMapè¿›è¡Œåˆ†æï¼Œå…¶å®ä¹Ÿå°±æ˜¯å¯¹çº¢é»‘æ ‘è¿›è¡Œå¢åˆ æŸ¥æ”¹ã€‚æœ¬æ–‡è¿™é‡Œå°±ä¸å†è¿›è¡Œèµ˜è¿°ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹è¿™ç¯‡<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/e136ec79235c">åšå®¢</a>ã€‚</p>
<h2 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h2><p>hashMapæ’åºæ˜¯æ ¹æ®keyå€¼çš„å¤§å°è¿›è¡Œæ’åºçš„</p>
<ul>
<li>è‡ªç„¶æ’åºï¼šTreeMapçš„æ‰€æœ‰Keyå¿…é¡»å®ç°Comparableæ¥å£</li>
<li>å®šåˆ¶æ’åºï¼šåˆ›å»ºTreemapå¯¹è±¡æ—¶ï¼Œè¯¥å¯¹è±¡è´Ÿè´£å¯¹TreeMapä¸­çš„æ‰€æœ‰keyè¿›è¡Œæ’åºã€‚æ­¤æ—¶ä¸éœ€è¦Mapçš„keyå®ç°Comparableæ¥å£</li>
</ul>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>å°æœ±</li><li class="post-copyright-link"><strong>Post link: </strong><a href="http://example.com/2022/04/18/Java%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6%E4%B9%8BMap/" title="Javaé›†åˆæ¡†æ¶ä¹‹Map">http://example.com/2022/04/18/Java%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6%E4%B9%8BMap/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> unless otherwise stated.</li></ul></article><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"><a class="post-nav-next" href="/2022/01/24/Java%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6%E4%B9%8BQueue/" rel="next" title="Javaé›†åˆæ¡†æ¶ä¹‹Queue"><span class="post-nav-text">Javaé›†åˆæ¡†æ¶ä¹‹Queue</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 â€“ 2022 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> xiaozhu-sorce</span></div><div class="powered"><span>Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v5.4.2</span><span class="footer-separator">|</span><span>Theme - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.8.11</span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true,"opacity":0.7},"log":false});</script></body></html>